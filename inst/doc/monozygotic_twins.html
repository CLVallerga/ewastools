<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jonathan Heiss" />

<meta name="date" content="2018-01-04" />

<title>Showcase: monozygotic twins</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Showcase: monozygotic twins</h1>
<h4 class="author"><em>Jonathan Heiss</em></h4>
<h4 class="date"><em>2018-01-04</em></h4>



<style>
body{ font-size: 12pt; text-align: justify; }
p.caption {text-align: justify; font-style: italic; margin-left: 8mm;}
</style>
<p><em>This vignette demonstrates the use of the ewastools package on a public available 450K dataset, with a focus on the implemented quality checks for identifying failed assays, mislabeled or contaminated samples. ewastools provides also functions for preprocessing (dye bias correction, normalization) and estimation of leukocyte composition.</em></p>
<p>Download the GEOmetadb database and extract the metadata for the GSE61496 dataset. This dataset is comprised of 150 pairs of monozygotic twins (i.e.Â 300 samples + 10 technical replicates).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getSQLiteFile</span>(<span class="dt">destdir=</span><span class="st">&quot;../data-raw&quot;</span>)</code></pre></div>
<pre><code>## Unzipping...
## Metadata associate with downloaded file:
##                 name               value
## 1     schema version                 1.0
## 2 creation timestamp 2017-12-31 02:02:57</code></pre>
<pre><code>## [1] &quot;../data-raw/GEOmetadb.sqlite&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(<span class="kw">SQLite</span>(), <span class="st">&quot;../data-raw/GEOmetadb.sqlite&quot;</span>)

samples =<span class="st"> </span><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT gsm,series_id,supplementary_file,characteristics_ch1 FROM gsm</span>
<span class="st">    WHERE gpl='GPL13534' AND series_id like 'GSE61496'&quot;</span>)
<span class="kw">setDT</span>(samples)
<span class="kw">dbDisconnect</span>(con)</code></pre></div>
<p>Extract the metadata (sex and ID of twin pairs). Remove the two samples without metadata.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meta =<span class="st"> </span><span class="kw">stri_match</span>(samples<span class="op">$</span>characteristics_ch1,
    <span class="dt">regex=</span><span class="st">&quot;2=f: ([12]);.*age: (</span><span class="ch">\\</span><span class="st">d+);.*pair id: (</span><span class="ch">\\</span><span class="st">d+)&quot;</span>)
samples<span class="op">$</span>sex =<span class="st"> </span>meta[,<span class="dv">2</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">factor</span>(<span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>),<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;m&quot;</span>,<span class="st">&quot;f&quot;</span>))
samples<span class="op">$</span>pair_id =<span class="st"> </span><span class="kw">as.numeric</span>(meta[,<span class="dv">4</span>])
samples =<span class="st"> </span>samples[<span class="op">!</span><span class="kw">is.na</span>(sex)]
<span class="kw">rm</span>(meta)</code></pre></div>
<p>Swap two samples on purpose.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">swap =<span class="st"> </span>samples[<span class="dv">145</span>]<span class="op">$</span>supplementary_file
samples[<span class="dv">145</span>]<span class="op">$</span>supplementary_file =<span class="st"> </span>samples[<span class="dv">65</span>]<span class="op">$</span>supplementary_file
samples[<span class="dv">65</span>]<span class="op">$</span>supplementary_file =<span class="st"> </span>swap
<span class="kw">rm</span>(swap)</code></pre></div>
<p>Parse the .idat file names, create a new folder and download the dataset. Requires approx. 2.5GB of storage.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">files =<span class="st"> </span><span class="kw">stri_match</span>(samples<span class="op">$</span>supplementary_file,
    <span class="dt">regex=</span><span class="st">&quot;^(ftp://ftp</span><span class="ch">\\</span><span class="st">S*Grn</span><span class="ch">\\</span><span class="st">.idat</span><span class="ch">\\</span><span class="st">.gz);[:blank:](ftp://ftp</span><span class="ch">\\</span><span class="st">S*Red</span><span class="ch">\\</span><span class="st">.idat</span><span class="ch">\\</span><span class="st">.gz)&quot;</span>)
files =<span class="st"> </span>files[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]

<span class="kw">dir.create</span>(<span class="st">&quot;../data-raw/GSE61496&quot;</span>)</code></pre></div>
<pre><code>## Warning in dir.create(&quot;../data-raw/GSE61496&quot;): '..\data-raw\GSE61496'
## already exists</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">invisible</span>(<span class="kw">lapply</span>(files,<span class="cf">function</span>(file) <span class="kw">download.file</span>(file,<span class="dt">destfile=</span><span class="kw">paste0</span>(<span class="st">&quot;../data-raw/GSE61496/&quot;</span>,<span class="kw">basename</span>(file)),<span class="dt">quiet=</span><span class="ot">TRUE</span>) ))

files =<span class="st"> </span><span class="kw">basename</span>(files)
files =<span class="st"> </span><span class="kw">stri_sub</span>(files[<span class="dv">1</span><span class="op">:</span><span class="dv">310</span>],<span class="dv">1</span>,<span class="op">-</span><span class="dv">13</span>)
samples<span class="op">$</span>file =<span class="st"> </span>files
samples =<span class="st"> </span>samples[,<span class="kw">list</span>(gsm,pair_id,sex,file)]</code></pre></div>
<p>Read in the dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">raw =<span class="st"> </span><span class="kw">read_idats</span>(<span class="kw">paste0</span>(<span class="st">&quot;../data-raw/GSE61496/&quot;</span>,samples<span class="op">$</span>file),<span class="dt">quiet=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 622399</code></pre>
<pre><code>## Warning in UseMethod(&quot;as.list&quot;): closing unused connection 5 (https://
## gbnci-abcc.ncifcrf.gov/geo/GEOmetadb.sqlite.gz)</code></pre>
<p>The first check evaluates 17 control metrics. The âBisulfite Conversion IIâ metric is exemplary plotted below. 3 samples fall below 1, which is the cut-off recommended by Illumina.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ctrls =<span class="st"> </span><span class="kw">control_metrics</span>(raw)
<span class="kw">stripchart</span>(ctrls<span class="op">$</span><span class="st">`</span><span class="dt">Bisulfite Conversion II</span><span class="st">`</span>,<span class="dt">method=</span><span class="st">&quot;jitter&quot;</span>,<span class="dt">pch=</span><span class="dv">4</span>,<span class="dt">xlab=</span><span class="st">'Bisulfite Conversion II'</span>)
<span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>A logical vector of passed/failed is returned by <code>sample_failure()</code>. In this case, 26 samples were flagged. These samples warrant closer inspection (weâll skip this).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sample_failure</span>(ctrls) <span class="op">%&gt;%</span><span class="st"> </span>table</code></pre></div>
<pre><code>## .
## FALSE  TRUE 
##   284    26</code></pre>
<p>Before the next check, dye bias is corrected and beta-values are computed. No normalization is performed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dye =<span class="st"> </span><span class="kw">correct_dye_bias</span>(raw)
meth =<span class="st"> </span><span class="kw">dont_normalize</span>(dye)</code></pre></div>
<p>Sex check. The samples swapped above resulted in sex mismatches plotted in red. The actual sex of a sample donor can be inferred by calling <code>predict_sex()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">XY =<span class="st"> </span><span class="kw">check_sex</span>(dye)
samples<span class="op">$</span>X =<span class="st"> </span>XY<span class="op">$</span>X
samples<span class="op">$</span>Y =<span class="st"> </span>XY<span class="op">$</span>Y
<span class="kw">rm</span>(XY)

samples<span class="op">$</span>predicted_sex =<span class="st"> </span><span class="kw">predict_sex</span>(samples<span class="op">$</span>X,samples<span class="op">$</span>Y,<span class="kw">which</span>(samples<span class="op">$</span>sex<span class="op">==</span><span class="st">'m'</span>),<span class="kw">which</span>(samples<span class="op">$</span>sex<span class="op">==</span><span class="st">'f'</span>))

<span class="kw">plot</span>(X<span class="op">~</span>Y,<span class="dt">data=</span>samples,<span class="dt">pch=</span><span class="kw">ifelse</span>(samples<span class="op">$</span>sex<span class="op">==</span><span class="st">&quot;f&quot;</span>,<span class="dv">1</span>,<span class="dv">4</span>),<span class="dt">asp=</span><span class="dv">1</span>,<span class="dt">xlab=</span><span class="st">&quot;Normalized X chromosome intensities&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Normalized Y chromosome intensities&quot;</span>)
<span class="kw">points</span>(X<span class="op">~</span>Y,<span class="dt">data=</span>samples[sex<span class="op">!=</span>predicted_sex],<span class="dt">pch=</span><span class="kw">ifelse</span>(samples<span class="op">$</span>sex<span class="op">==</span><span class="st">&quot;f&quot;</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">col=</span><span class="dv">2</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Genotype calling and classification of SNP outliers. First extract SNP probe positions from the manifest and use the matrix of beta-values as input for <code>call_genotypes</code>. This function estimates the parameters of a mixture model and returns posterior probabilities used as soft classification.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">snps =<span class="st"> </span>dye<span class="op">$</span>manifest[probe_type<span class="op">==</span><span class="st">'rs'</span>,index]
snps =<span class="st"> </span>meth[snps,]

gt =<span class="st"> </span><span class="kw">call_genotypes</span>(snps)</code></pre></div>
<p>Use the classified SNPs to compare genetic fingerprints between samples. Monozygotic twins are in this check treated as one donor. List all conflicts, e.g.Â unexpected agreement or disagreement of fingerprints. The sample swap resulted in 8 conflicts: rows 1,4 and 5 indicate that sample #65 does not have the same fingerprint as #59, #303 and #309, even though they are supposed to come from the same donor. Analogously, row 6 indicates that sample #145 does not match the genetic fingerprint of sample #151. Rows 2,3,7 and 8 on the other hand shows the unexpected fingerprint matches between samples that are supposed to come from two different donors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">check_snp_agreement</span>(gt<span class="op">$</span>gamma,<span class="dv">1</span><span class="op">-</span>gt<span class="op">$</span>outliers,samples<span class="op">$</span>pair_id,<span class="dv">1</span><span class="op">:</span><span class="dv">310</span>)</code></pre></div>
<pre><code>## $`309`
##    donor1 sample1 donor2 sample2 similarity
## 1:     29      59     29      65  0.4248898
## 2:     29      59     61     145  1.0000000
## 3:     29      65     61     151  0.9998955
## 4:     29      65     29     303  0.4062816
## 5:     29      65     29     309  0.4064331
## 6:     61     145     61     151  0.4372906
## 7:     61     145     29     303  1.0000000
## 8:     61     145     29     309  1.0000000</code></pre>
<p>The same data can be shown as a plot. The label âTRUEâ corresponds to twin pairs, âFALSEâ to non-twin pairs. There are eight (overlapping) outliers corresponding to the entries in the list above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">agreement_</span>(gt<span class="op">$</span>gamma,<span class="dv">1</span><span class="op">-</span>gt<span class="op">$</span>outliers,samples<span class="op">$</span>pair_id,<span class="dv">1</span><span class="op">:</span><span class="dv">310</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZjpmtrZmtv+QOgCQOmaQZgCQkGaQ2/+2ZgC2Zma2tma225C2/7a2///bkDrbkJDb////tmb/25D//7b//9v////BrzTnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKPUlEQVR4nO3dDVvi6BmG4ejottpW25V+LN2o/P8/uYQvjZCdwP0GEzjPPdZBRp4JcB0hiRqqBQSq714Apk1ARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBESkcEAVF+K7Aio7ju8iICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgLiCPs/QCYgjiAgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiJypoDeHp+2F+vb3+JxjMY5A3p/flgI6MIIiIiAiAiIiICICIiIgIicLaCPM+EL6JI4Ek1EQETO/hL24/cC4xiNc6+B3p87NoEENE1nfwl7f74rOY5vdv5toHnHi5iAJukbArIbf0kERMRLGBEb0SVsH8XVn0e87ewE7e7d5v11zx7Q7AJ346vP/28vXKbdvavW/x14m2YHEo+1WftsHtjq46rLs72rm3u76ac68DW9h8WLdPTbjY+OgA58Te9hx/v/pe2FCejA1/Qe1td883Mcnd/LmPBjbhvo65f0ntVbffOymC23f+qqeigwbmTshX3+it6jjvhnVzvvb49P82oZUj6O0Tjbj3M8NBX9teo4CHTkOEbjrL/aPOt6+Tp2HKNx3oA6DwIdOY7ROG9A3S9gApooAREREBG/F0bEr/UQERCR85/irsQ4RkNARAREREBE7MYTsQYiIiAiAiIiICKORBMREBEBEREQEQERERARAREREBEBEREQEQER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" style="display: block; margin: auto;" /></p>
<p>Check for outliers among the SNP probes. Such can indicate sample contamination or other technical problems. There are 7 samples that lie above our recommended cut-off.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">log_odds =<span class="st"> </span><span class="kw">snp_outliers</span>(gt)
<span class="kw">table</span>(log_odds <span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="dv">4</span>)</code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   303     7</code></pre>
<p>Check if the 26 flagged samples perform worse on the outlier metric (the average log odds of being an outlier across the 65 SNP probes). Answer: they do, confirming that these samples warrant closer inspection.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>( <span class="kw">split</span>(log_odds,<span class="kw">sample_failure</span>(ctrls)),<span class="dt">horizontal=</span><span class="ot">TRUE</span>,<span class="dt">xlab=</span><span class="st">&quot;Average log odds&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v=</span><span class="op">-</span><span class="dv">4</span>,<span class="dt">lty=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZjpmZmZmtv+QOgCQOmaQZgCQkGaQ2/+2ZgC2Zma2tma225C2/7a2///bkDrbkJDb////AAD/tmb/25D//7b//9v////uUSMqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALuElEQVR4nO2dC2OjNhZGySTp1u5u0jZ0d8vOEIf//yMXCYztiR0/vivrdU47DoHLxR6OdSXGFs0AINDEfgKQNwgEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEsYCNVAIsQSyTQexQCCQQCBbfsR+AvcGgWxBIDkwSjqIBQKBBALZQgmTA6OkSwYEkgOjpINYIBBIIJAtlDA5MEq6ZEAgOTBKOogFAoEEAtlCCZMDo6RLBgSSAwOli/IhKDhLPgJ9ufE6JxDIDgSyhRImBwZKh0BpgkAggUAggUC2UMLkwEDpEChNEAgkEAgkEMgWSpgcGCgdAqUJAoEEAoEEAtlCCZMDA6VDoDRBIJBAIJAIItBm/bJd7L/9Lac7v0M6AlHC5MBhFujjdTUgUPGkKNDRbZkIdKcDpAMChQCBhMChaoF+hD5AaiCQLQgkBw5VC3SnA6QDAoUAgYTAwQm0+xJoZQJRwuRAPR0CZQQChQCBhMBhv4Q9fr8hHQJlRNgW6OP1RBeoWIEoYXLgAR+vT9enQ6CMCN0H6k4UsVIFutMB0iG4QJUN4+90gHRAIFsoYXLgIbWVMASSAw+orhN99ADlzMr4+ZUEFqitbRh/7ADNPQ55F468Ei4k2nKkhDWhj3k3jr2SO/9TxkUz7W63H/w0FehTdrOfP5bfd0fbe8ybKAL9r65R2JEDINB1gZ5u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" style="display: block; margin: auto;" /></p>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
